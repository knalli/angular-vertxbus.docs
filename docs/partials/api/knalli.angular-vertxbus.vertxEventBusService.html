<h1><code ng:non-bindable="">vertxEventBusService</code>
<div><span class="hint">service in module <code ng:non-bindable="">knalli.angular-vertxbus</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="knalli-angular-vertxbus-vertxeventbusservice-page"><p>A service utilizing an underlying Vert.x Event Bus</p>
<p>The advanced features of this service are:</p>
<ul>
<li>broadcasting the connection changes (vertx-eventbus.system.connected, vertx-eventbus.system.disconnected) on $rootScope</li>
<li>registering all handlers again when a reconnect had been required</li>
<li>supporting a promise when using send()</li>
<li>adding aliases on (registerHandler), un (unregisterHandler) and emit (publish)</li>
</ul>
<p>Basic usage:
<pre class="prettyprint linenums">
module.controller('MyController', function('vertxEventService') {
  vertxEventService.on('my.address', function(message) {
    console.log("JSON Message received: ", message)
  });
  vertxEventService.publish('my.other.address', {type: 'foo', data: 'bar'});
});
</pre>
<p>Note the additional <a href="#/api/knalli.angular-vertxbus.vertxEventBusServiceProvider">configuration</a> of the module itself.</p>
</div></div>
<h2 id="dependencies">Dependencies</h2>
<ul class="dependencies"><li><code ng:non-bindable=""><a href="#/api/knalli.angular-vertxbus.vertxEventBus">vertxEventBus</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/ng.$rootScope">$rootScope</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/ng.$q">$q</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/ng.$interval">$interval</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/ng.$log">$log</a></code>
</li>
</ul>
<div class="member method"><h2 id="methods">Methods</h2>
<ul class="methods"><li><h3 id="methods_ensureopenauthconnection">ensureOpenAuthConnection(fn)</h3>
<div class="ensureopenauthconnection"><div class="-ensureopenauthconnection-page"><p>Ensures the callback will be performed with a valid session.</p>
<p>Unless <code>loginRequired</code> is enabled, this will be simple forward.</p>
<p>Unless a valid session exist (but required), the callback will be not invoked.</p>
</div><h5 id="methods_ensureopenauthconnection_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>fn</td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="-ensureopenauthconnection-page"><p>callback</p>
</div></td></tr></tbody></table><h5 id="methods_ensureopenauthconnection_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-ensureopenauthconnection-page"><p>false if the callback cannot be performed or queued</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_ensureopenconnection">ensureOpenConnection(fn)</h3>
<div class="ensureopenconnection"><div class="-ensureopenconnection-page"><p>Ensures the callback will be performed with an open connection.</p>
<p>Unless an open connection was found, the callback will be queued in the message buffer (if available).</p>
</div><h5 id="methods_ensureopenconnection_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>fn</td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="-ensureopenconnection-page"><p>callback</p>
</div></td></tr></tbody></table><h5 id="methods_ensureopenconnection_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-ensureopenconnection-page"><p>false if the callback cannot be performed or queued</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getconnectionstate">getConnectionState(immediate)</h3>
<div class="getconnectionstate"><div class="-getconnectionstate-page"><p>Returns the current connection state. The state is being cached internally.</p>
</div><h5 id="methods_getconnectionstate_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>immediate <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-getconnectionstate-page"><p>if true, the connection state will be queried directly.</p>
</div> <p><em>(default: false)</em></p></td></tr></tbody></table><h5 id="methods_getconnectionstate_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-number">number</a></td><td><div class="-getconnectionstate-page"><p>state type of vertx.EventBus</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_isconnectionopen">isConnectionOpen()</h3>
<div class="isconnectionopen"><div class="-isconnectionopen-page"><p>Returns true if the current connection state (<a href="#/api/knalli.angular-vertxbus.vertxEventBusService#methods_getconnectionstate">getConnectionState()</a>) is <code>OPEN</code>.</p>
</div><h5 id="methods_isconnectionopen_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-isconnectionopen-page"><p>connection open state</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_isconnectionopen">isConnectionOpen()</h3>
<div class="isconnectionopen"><div class="-isconnectionopen-page"><p>Returns the current amount of messages in the internal buffer.</p>
</div><h5 id="methods_isconnectionopen_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-number">number</a></td><td><div class="-isconnectionopen-page"><p>amount</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_isenabled">isEnabled()</h3>
<div class="isenabled"><div class="-isenabled-page"><p>Returns true if service is being enabled.</p>
</div><h5 id="methods_isenabled_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-isenabled-page"><p>state</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_isvalidsession">isValidSession()</h3>
<div class="isvalidsession"><div class="-isvalidsession-page"><p>Returns true if the session is valid</p>
</div><h5 id="methods_isvalidsession_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-isvalidsession-page"><p>state</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_observe">observe(observer)</h3>
<div class="observe"><div class="-observe-page"><p>Adds an observer</p>
</div><h5 id="methods_observe_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>observer</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="-observe-page"><p>observer</p>
</div><table><thead><tr><th>Property</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>afterEventbusConnected <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="-observe-page"><p>will be called after establishing a new connection</p>
</div></td></tr></tbody></table></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_publish">publish(address, message)</h3>
<div class="publish"><div class="-publish-page"><p>Publishes a message to the specified address (using <a href="#/api/knalli.angular-vertxbus.vertxEventBus#methods_publish">vertxEventBus.publish()</a>).</p>
</div><h5 id="methods_publish_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>address</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="-publish-page"><p>target address</p>
</div></td></tr><tr><td>message</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="-publish-page"><p>payload message</p>
</div></td></tr></tbody></table><h5 id="methods_publish_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-publish-page"><p>false if cannot be send or queued</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_registerhandler">registerHandler(address, callback)</h3>
<div class="registerhandler"><div class="-registerhandler-page"><p>Registers a callback handler for the specified address match.</p>
</div><h5 id="methods_registerhandler_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>address</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="-registerhandler-page"><p>target address</p>
</div></td></tr><tr><td>callback</td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="-registerhandler-page"><p>handler with params <code>(message, replyTo)</code></p>
</div></td></tr></tbody></table><h5 id="methods_registerhandler_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-function">function=</a></td><td><div class="-registerhandler-page"><p>deconstructor</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_send">send(address, message, timeout, expectReply)</h3>
<div class="send"><div class="-send-page"><p>Sends a message to the specified address (using <a href="#/api/knalli.angular-vertxbus.vertxEventBus#methods_send">vertxEventBus.send()</a>).</p>
</div><h5 id="methods_send_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>address</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="-send-page"><p>target address</p>
</div></td></tr><tr><td>message</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="-send-page"><p>payload message</p>
</div></td></tr><tr><td>timeout <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-number">number</a></td><td><div class="-send-page"><p>timeout (in ms) after which the promise will be rejected</p>
</div> <p><em>(default: 10000)</em></p></td></tr><tr><td>expectReply <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="-send-page"><p>if false, the promise will be resolved directly and
no replyHandler will be created</p>
</div> <p><em>(default: true)</em></p></td></tr></tbody></table><h5 id="methods_send_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="-send-page"><p>promise</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_unregisterhandler">unregisterHandler(address, callback)</h3>
<div class="unregisterhandler"><div class="-unregisterhandler-page"><p>Removes a callback handler for the specified address match.</p>
</div><h5 id="methods_unregisterhandler_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>address</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="-unregisterhandler-page"><p>target address</p>
</div></td></tr><tr><td>callback</td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="-unregisterhandler-page"><p>handler with params <code>(message, replyTo)</code></p>
</div></td></tr></tbody></table></div>
</li>
</ul>
</div>
<div class="member event"><h2 id="events">Events</h2>
<ul class="events"><li><h3 id="events_connected">connected</h3>
<div class="connected"><div class="connected-page"><p>After a connection was being established</p>
<p>Event name is <code>prefix + &#39;system.connected&#39;</code> (see <a href="#/api/knalli.angular-vertxbus.vertxEventBusServiceProvider#methods_useprefix">prefix</a>)</p>
</div><div class="inline"><h4 id="events_connected_type">Type:</h4>
<div class="type">broadcast</div>
</div>
<div class="inline"><h4 id="events_connected_target">Target:</h4>
<div class="target">$rootScope</div>
</div>
</div>
</li>
<li><h3 id="events_disconnected">disconnected</h3>
<div class="disconnected"><div class="disconnected-page"><p>After a connection was being terminated.</p>
<p>Event name is <code>prefix + &#39;system.disconnected&#39;</code> (see <a href="#/api/knalli.angular-vertxbus.vertxEventBusServiceProvider#methods_useprefix">prefix</a>)</p>
</div><div class="inline"><h4 id="events_disconnected_type">Type:</h4>
<div class="type">broadcast</div>
</div>
<div class="inline"><h4 id="events_disconnected_target">Target:</h4>
<div class="target">$rootScope</div>
</div>
</div>
</li>
<li><h3 id="events_login-failed">login-failed</h3>
<div class="login-failed"><div class="login-failed-page"><p>After a login has been destroyed or was invalidated</p>
<p>Event name is <code>prefix + &#39;system.login.failed&#39;</code> (see <a href="#/api/knalli.angular-vertxbus.vertxEventBusServiceProvider#methods_useprefix">prefix</a>)</p>
</div><div class="inline"><h4 id="events_login-failed_type">Type:</h4>
<div class="type">broadcast</div>
</div>
<div class="inline"><h4 id="events_login-failed_target">Target:</h4>
<div class="target">$rootScope</div>
</div>
<h5 id="events_login-failed_target_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>data</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="login-failed-page"><p>data</p>
</div><table><thead><tr><th>Property</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>status</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="login-failed-page"><p>must be not<code>&#39;ok&#39;</code></p>
</div></td></tr></tbody></table></td></tr></tbody></table></div>
</li>
<li><h3 id="events_login-succeeded">login-succeeded</h3>
<div class="login-succeeded"><div class="login-succeeded-page"><p>After a login has been validated successfully</p>
<p>Event name is <code>prefix + &#39;system.login.succeeded&#39;</code> (see <a href="#/api/knalli.angular-vertxbus.vertxEventBusServiceProvider#methods_useprefix">prefix</a>)</p>
</div><div class="inline"><h4 id="events_login-succeeded_type">Type:</h4>
<div class="type">broadcast</div>
</div>
<div class="inline"><h4 id="events_login-succeeded_target">Target:</h4>
<div class="target">$rootScope</div>
</div>
<h5 id="events_login-succeeded_target_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>data</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="login-succeeded-page"><p>data</p>
</div><table><thead><tr><th>Property</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>status</td><td><a href="" class="label type-hint type-hint-boolean">boolean</a></td><td><div class="login-succeeded-page"><p>must be <code>&#39;ok&#39;</code></p>
</div></td></tr></tbody></table></td></tr></tbody></table></div>
</li>
</ul>
</div>
</div>
